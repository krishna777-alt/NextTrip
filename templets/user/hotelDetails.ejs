<%- include("navBar") %>
    <% if(hotel){%>
      <title><%= hotel.name %> | Details</title>
      <%}else{%>
        <title>Hotel Details | Details</title>
        <%}%>
    <script src="https://cdn.tailwindcss.com"></script>

    <style>
      .fade-card {
        transition: all 0.2s ease;
      }
      .fade-card:hover {
        transform: translateY(-3px);
        box-shadow: 0px 8px 22px rgba(0, 0, 0, 0.08);
      }
    </style>
  </head>

  <body class="bg-gray-50 text-gray-800">
    <!-- Hero Banner -->
      <section
      class="text-center py-20 text-white bg-cover bg-center relative"
      style="
        background-image: url('/images/hotelDetails-header.jpg');
      "
    >
      <!-- Overlay -->
      <div class="absolute inset-0 bg-blue-700/50"></div>

      <div class="relative z-10">
        <h1 class="text-4xl font-bold"><%= hotel.name%></h1>
        <!-- <p class="mt-2 text-lg">Find the best tourist places across India</p> -->
      </div>
    </section>
   

    <!-- Breadcrumb -->
    <div class="max-w-7xl mx-auto mt-6 px-4">
      <p class="text-gray-600">
        Home > Rooms >
        <span class="text-indigo-600"><%= hotel.name %></span>
      </p>
    </div>

    <!-- Main Layout (FIXED GRID) -->
    <div
      class="max-w-7xl mx-auto mt-10 px-4 grid grid-cols-1 lg:grid-cols-3 gap-10"
    >
      <!-- LEFT CONTENT (Rooms + Details + Rules + Map) -->
      <div class="lg:col-span-2 space-y-10">
        <!-- Top Image Section -->
<div class="grid grid-cols-3 gap-4">
  <!-- LEFT GALLERY -->
  <div class="col-span-1 grid grid-cols-2 grid-rows-2 gap-4 h-72">
    <% if (hotel.galleryImages.length <= 4) { %>
      <% hotel.galleryImages.forEach((img, index) => { %>
        <div class="rounded-xl shadow overflow-hidden cursor-pointer gallery-thumb">
          <img
            src="/uploads/hotels/<%= img %>"
            data-index="<%= index %>"
            class="w-full h-full object-cover hover:scale-105 transition-transform duration-300"
          />
        </div>
      <% }) %>
    <% } else { %>
      <% for (let i = 0; i < 4; i++) { %>
        <% if (i < 3) { %>
          <div class="rounded-xl shadow overflow-hidden cursor-pointer gallery-thumb">
            <img
              src="/uploads/hotels/<%= hotel.galleryImages[i] %>"
              data-index="<%= i %>"
              class="w-full h-full object-cover hover:scale-105 transition-transform duration-300"
            />
          </div>
        <% } else { %>
          <div class="rounded-xl shadow overflow-hidden cursor-pointer gallery-thumb relative">
            <img
              src="/uploads/hotels/<%= hotel.galleryImages[i] %>"
              data-index="<%= i %>"
              class="w-full h-full object-cover hover:scale-105 transition-transform duration-300"
            />
            <div class="absolute inset-0 bg-black bg-opacity-50 flex items-center justify-center text-white text-lg font-bold more-overlay">
              +<%= hotel.galleryImages.length - 4 %> more
            </div>
          </div>
        <% } %>
      <% } %>
    <% } %>
  </div>

  <!-- MAIN IMAGE -->
  <div class="col-span-2 h-72 rounded-xl shadow overflow-hidden cursor-pointer gallery-thumb">
    <img
      src="/uploads/hotels/<%= hotel.image %>"
      data-index="0"
      class="w-full h-full object-cover hover:scale-105 transition-transform duration-300"
    />
  </div>
</div>

        <!-- Main Room Info -->
        <div class="bg-white p-6 rounded-xl shadow-sm border fade-card">
          <div class="flex justify-between items-start flex-wrap">
            <div>
              <h2 class="text-2xl font-bold"><%= hotel.name %></h2>
              <p class="text-sm text-gray-500 mt-2">
                <%= hotel.address %>, <%= hotel.state %>
              </p>
            </div>

            <div class="flex items-center gap-2 mt-3 lg:mt-0">
              <span class="text-amber-500 text-xl">â˜…</span>
              <span class="font-semibold"><%= hotel.rating.toFixed(1) %></span>
              <span class="text-gray-500">(245 Reviews)</span>
            </div>
          </div>

          <div class="mt-6 flex items-center gap-3">
            <!-- <p class="text-3xl font-bold text-indigo-600">
              â‚¹
            </p> -->
            <!-- <span class="text-gray-500">/ night</span> -->
          </div>

          <div class="mt-6 flex flex-wrap gap-6 text-gray-600 text-sm">
            <div class="flex items-center gap-2">ğŸ› <span>1 Bed</span></div>
            <div class="flex items-center gap-2">ğŸš¿ <span>1 Bath</span></div>
            <div class="flex items-center gap-2">ğŸ“ <span>300 sqft</span></div>
            <div class="flex items-center gap-2">ğŸ‘¥ <span>2 Guests</span></div>
          </div>

          <div class="mt-7 flex gap-4">
            <a
              href="/hotelRooms/<%= hotel._id %>"
              class="bg-indigo-600 text-white px-6 py-3 rounded-xl shadow hover:bg-indigo-700 fade-card"
            >
              Check out rooms
            </a>

            <a
              href="/hotels"
              class="bg-gray-200 text-gray-700 px-6 py-3 rounded-xl hover:bg-gray-300 fade-card"
            >
              Back
            </a>
          </div>
        </div>

        <!-- Overview -->
        <div class="bg-white p-6 rounded-xl shadow-sm border fade-card">
          <h3 class="text-xl font-semibold">Overview</h3>
          <p class="mt-3 text-gray-700 leading-relaxed">
            <%= hotel.description %>
          </p>
        </div>

        <!-- Amenities -->
        <div class="bg-white p-6 rounded-xl shadow-sm border fade-card">
          <h3 class="text-xl font-semibold">Room Amenities</h3>

          <div class="grid grid-cols-2 md:grid-cols-3 gap-4 mt-5">
            <% hotel.amenities.forEach(a => { %>
            <div
              class="flex items-center gap-3 bg-gray-50 px-4 py-3 rounded-xl border fade-card"
            >
              <span class="text-indigo-600">âœ”</span>
              <span><%= a %></span>
            </div>
            <% }) %>
          </div>
        </div>

        <!-- Booking Rules -->
        <div class="bg-white p-6 rounded-xl shadow-sm border fade-card">
          <h3 class="text-xl font-semibold">Booking Rules</h3>

          <div class="mt-6 grid grid-cols-2 gap-10">
            <div>
              <h4 class="font-medium mb-3">Check In</h4>
              <ul class="space-y-2 text-gray-600">
                <li>âœ” ID required</li>
                <li>âœ” Standard check-in timing</li>
                <li>âœ” Early check-in on request</li>
              </ul>
            </div>

            <div>
              <h4 class="font-medium mb-3">Check Out</h4>
              <ul class="space-y-2 text-gray-600">
                <li>âœ” Standard check-out time</li>
                <li>âœ” Late check-out (charges apply)</li>
                <li>âœ” Baggage storage available</li>
              </ul>
            </div>
          </div>
        </div>
        
        <!-- Map -->
        <div class="bg-white p-6 rounded-xl shadow-sm border fade-card">
          <h3 class="text-lg font-semibold">Location</h3>

          <div class="mt-5">
            <iframe
              height="330"
              width="100%"
              class="rounded-xl border"
              src="https://www.google.com/maps?q=<%= encodeURIComponent(hotel.address) %>&output=embed"
            >
            </iframe>
          </div>
        </div>
        
      </div>
      <!-- RIGHT SIDE: STICKY BOOKING FORM (FIXED!) -->
     <div class="lg:col-span-1">
  <div class="sticky top-24 space-y-6">

    <!-- ROOM AVAILABILITY -->
    <div class="bg-white rounded-xl shadow-sm border p-5">
      <h3 class="text-base font-semibold mb-4">Room Availability</h3>

      <!-- LEGEND -->
      <div class="flex gap-4 text-xs text-gray-600 mb-4">
        <div class="flex items-center gap-2">
          <span class="w-3 h-3 rounded-full bg-blue-500"></span>
          Available
        </div>
        <div class="flex items-center gap-2">
          <span class="w-3 h-3 rounded-full bg-gray-900"></span>
          Booked
        </div>
      </div>

      <!-- ROOMS GRID -->
      <div class="grid grid-cols-6 gap-2 max-h-56 overflow-y-auto pr-1">
        <% room.forEach(r => { %>
          <div
            class="w-8 h-8 flex items-center justify-center rounded-full text-xs font-medium
            <%= r.isBooked
              ? 'bg-gray-900 text-white cursor-not-allowed opacity-80'
              : 'bg-blue-500 text-white hover:scale-110 transition cursor-pointer' %>"
            title="Room <%= r.roomNum %>"
          >
            
            <a href="http://localhost:3000/hotelRooms/displayRooms/<%= r._id%>"><%= r.roomNum %></a>
          </div>
        <% }) %>
      </div>
    </div>


      <!-- SINGLE REVIEW -->
    
    </div>
    <%- include("hotelReview", {reviews}) %>
  </div>
  </div>
  
    </div>
 <%- include("footer") %>
<div
  id="galleryModal"
  class="fixed inset-0 bg-black/80 backdrop-blur-sm hidden z-50 flex items-center justify-center"
>
  <div class="relative max-w-5xl w-full px-4">
    <!-- Close Button -->
    <button
      id="closeGallery"
      class="absolute -top-12 right-4 text-white text-3xl"
    >
      âœ•
    </button>

    <!-- Main Image -->
    <div class="rounded-2xl overflow-hidden shadow-xl">
      <img
        id="galleryMainImage"
        src=""
        class="w-full h-[70vh] object-contain bg-black"
      />
    </div>

    <!-- Thumbnails -->
    <div class="flex gap-3 mt-4 overflow-x-auto justify-center">
      <% hotel.galleryImages.forEach((img, index) => { %>
        <img
          src="/uploads/hotels/<%= img %>"
          data-index="<%= index %>"
          class="w-20 h-14 object-cover rounded-lg cursor-pointer opacity-70 hover:opacity-100 border-2 border-transparent gallery-thumb-modal"
        />
      <% }) %>
    </div>
  </div>
</div>
<script>
  const modal = document.getElementById("galleryModal");
  const mainImage = document.getElementById("galleryMainImage");
  const closeBtn = document.getElementById("closeGallery");

  const mainImg = document.querySelector('.col-span-2 img');
  const thumbs = document.querySelectorAll(".gallery-thumb");
  const modalThumbs = document.querySelectorAll(".gallery-thumb-modal");

  function openGallery(src) {
    mainImage.src = src;
    modal.classList.remove("hidden");
    document.body.style.overflow = "hidden";
  }

  function closeGallery() {
    modal.classList.add("hidden");
    document.body.style.overflow = "auto";
  }

  // Thumbnails open modal
  thumbs.forEach(div => {
    div.addEventListener("click", () => {
      const img = div.querySelector('img');
      if (img) {
        openGallery(img.src);
      }
    });
  });

  // Main image opens modal
  mainImg.addEventListener("click", () => openGallery(mainImg.src));

  modalThumbs.forEach(img => {
    img.addEventListener("click", () => {
      mainImage.src = img.src;
      modalThumbs.forEach(t => t.classList.remove("border-white"));
      img.classList.add("border-white");
    });
  });

  closeBtn.addEventListener("click", closeGallery);

  modal.addEventListener("click", e => {
    if (e.target === modal) closeGallery();
  });

  document.addEventListener("keydown", e => {
    if (e.key === "Escape") closeGallery();
  });
</script>
